<!DOCTYPE html>
<html lang="en" class="dark">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>XRP Live Order Book • Global Aggregated</title>
  <link rel="icon" href="data:,">
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { margin:0; background:#000; font-family:system-ui,sans-serif; overflow-x:hidden; }
    .etf-card { transition:all 0.3s; }
    .etf-card:hover { transform:translateY(-4px); }

    #citymap { position:relative; height:520px; background:radial-gradient(circle at 50% 50%,#001122 0%,#000 70%); overflow:hidden; }
    @media(max-width:768px){ #citymap{height:340px} }

    .city { position:absolute; width:12px; height:12px; background:#00ffff; border-radius:50%; transform:translate(-50%,-50%); box-shadow:0 0 10px #00ffff60; }
    .city::after { content:attr(data-name); position:absolute; top:18px; left:50%; transform:translateX(-50%); font-size:11px; color:#00ffff90; opacity:0.6; transition:all 0.4s; }
    .city.active { z-index:10; animation:glow 1.6s ease-out; }
    .city.active::after { color:white; opacity:1; font-weight:bold; text-shadow:0 0 12px currentColor; }
    @keyframes glow { 0%{box-shadow:0 0 0 0 rgba(16,185,129,0.9);transform:translate(-50%,-50%) scale(1)} 70%{box-shadow:0 0 0 40px rgba(16,185,129,0);transform:translate(-50%,-50%) scale(2)} 100%{box-shadow:0 0 0 0 rgba(16,185,129,0);transform:translate(-50%,-50%) scale(1)} }
    .city.active.sell { animation:glow-sell 1.6s ease-out; }
    @keyframes glow-sell { 0%{box-shadow:0 0 0 0 rgba(239,68,68,0.9)} 70%{box-shadow:0 0 0 40px rgba(239,68,68,0)} 100%{box-shadow:0 0 0 0 rgba(239,68,68,0)} }

    #inflowAlert { position:fixed; top:0; left:0; right:0; z-index:9999; padding:16px; text-align:center; font-weight:bold; color:white; transform:translateY(-100%); transition:transform 0.6s ease; }
    #inflowAlert.show { transform:translateY(0); animation:pulse 4s infinite; }
    @keyframes pulse { 0%,100%{background:#0891b2} 50%{background:#10b981} }

    #supplyShock { background:linear-gradient(135deg,#001122 0%,#000 100%); border:1px solid #00ffff20; }
    .otc-warning { color:#ff6b35; font-weight:bold; }
    .ranking-badge { background:#00ffff20; color:#00ffff; padding:2px 6px; border-radius:4px; font-size:10px; }
    .market-open { color:#10b981; font-weight:bold; }
    .market-closed { color:#6b7280; font-weight:bold; }
  </style>
</head>
<body class="min-h-screen text-white">

<!-- ETF Inflow Alert Banner -->
<div id="inflowAlert">ETF INFLOW: Canary Capital XRPC +$47M → 22.9M XRP locked!</div>

<div class="border-b border-gray-800">
  <div class="max-w-7xl mx-auto px-4 py-4 flex items-center justify-between">
    <h1 class="text-2xl font-bold bg-gradient-to-r from-cyan-400 to-blue-600 bg-clip-text text-transparent">XRP Live Order Book</h1>
    <span class="px-3 py-1 text-xs bg-cyan-900 text-cyan-300 rounded-full">Global Aggregated • LIVE</span>
  </div>
</div>

<div class="max-w-7xl mx-auto p-4 grid grid-cols-1 lg:grid-cols-3 gap-6">

  <!-- Stats + Global Trade Flow + Order Book + Trades + ETFs + Clock (same layout as before) -->
  <!-- ... (keep all your existing sections exactly as in your current working version) ... -->

  <!-- Supply Shock with live alerts -->
  <div class="lg:col-span-3" id="supplyShock">
    <div class="px-6 py-4 border-b border-gray-800">
      <h2 class="text-lg font-semibold text-cyan-400">Supply Shock Tracker</h2>
    </div>
    <div class="p-6 grid grid-cols-1 md:grid-cols-3 gap-4">
      <div>Total ETF XRP Locked: <span id="totalLocked" class="text-cyan-400 font-bold">350.2M</span></div>
      <div>Effective Circ Supply: <span id="effectiveCirc" class="text-green-400 font-bold">59.95B</span></div>
      <div>YTD Inflows: <span id="totalInflows" class="text-green-400 font-bold">$666M</span></div>
      <div class="otc-warning col-span-full">OTC Desks 80% Dry — Exchange buys imminent</div>
    </div>
  </div>

  <!-- Status Clock with ETF Market Status -->
  <div class="lg:col-span-3 bg-gray-900 rounded-2xl border border-gray-800 text-center py-8">
    <div id="status" class="text-4xl font-bold text-green-400">LIVE</div>
    <div id="etfStatus" class="text-lg font-semibold mt-2 market-open">ETFs: OPEN</div>
    <div id="clock" class="text-5xl font-mono my-4">00:00:00 ET</div>
  </div>
</div>

<script>
let price = 2.05;
let totalLockedXRP = 350200000;
let totalCircSupply = 60331635327;

// Show inflow alert
function showInflowAlert(etfName, amountUSD, xrpAdded) {
  const banner = document.getElementById('inflowAlert');
  banner.textContent = `ETF INFLOW: ${etfName} +$${amountUSD.toLocaleString()}M → ${xrpAdded.toLocaleString()} XRP locked!`;
  banner.classList.add('show');
  setTimeout(() => banner.classList.remove('show'), 8000);

  // Global celebration glow
  document.querySelectorAll('.city').forEach(c => {
    c.classList.add('active');
    setTimeout(() => c.classList.remove('active'), 3000);
  });

  // Update totals
  totalLockedXRP += xrpAdded * 1000000;
  document.getElementById('totalLocked').textContent = (totalLockedXRP/1000000).toFixed(1)+'M';
  document.getElementById('effectiveCirc').textContent = (totalCircSupply - totalLockedXRP).toLocaleString();
}

// Simulated real-time ETF inflow detection (replace with real API later)
function checkForInflows() {
  // Random big inflow every ~2–10 minutes for demo
  if (Math.random() < 0.018) {
    const etfs = ["Canary XRPC", "Bitwise XRPT", "Franklin EZRP", "Grayscale GXRP"];
    const etf = etfs[Math.floor(Math.random()*etfs.length)];
    const amount = Math.floor(Math.random()*40) + 10; // $10M–$50M
    const xrp = Math.round(amount * 1000000 / price);
    showInflowAlert(etf, amount, xrp);
  }
}
setInterval(checkForInflows, 8000); // Check every 8s

// Your existing flashCity(), fetchLiveTrades(), updateAggregatedOrderBook(), updateClock(), etc.
// → just keep everything you already have

// Start everything
fetchLiveTrades();
setInterval(fetchLiveTrades, 5000);
updateAggregatedOrderBook();
setInterval(updateAggregatedOrderBook, 8000);
updateClock();
setInterval(updateClock, 1000);
</script>
</body>
</html>
